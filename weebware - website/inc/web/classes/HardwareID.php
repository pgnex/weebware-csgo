<?phpclass HardwareID {    static function fetchRequest($id) {        $db = Database::connect();        $stmt = $db->prepare("SELECT * FROM hwid_resets WHERE id=:id");        $stmt->execute([            "id" => $id        ]);        $data = $stmt->fetch();        return [            "id" => $data['id'],            "username" => $data['username'],            "reason" => $data['reason'],            "ip" => $data['ip'],            "cheat_ip" => User::getLastClient($data['username'])['ip']        ];    }    static function fetchPendingRequests() {        $db = Database::connect();        $get_resets = $db->prepare("SELECT * FROM hwid_resets WHERE status='PENDING'");        $get_resets->execute();        return $get_resets->fetchAll();    }    static function addRequest($username, $reason) {        $db = Database::connect();        $canRequest = self::checkUserRequest($username);        // Checks if user has previously been denied, or as a pending request.        if ($canRequest === -1 || $canRequest === 0) {            return false;        }        $stmt = $db->prepare("INSERT INTO hwid_resets (username, reason, ip, timestamp) VALUES (:username, :reason, :ip, :timestamp)");        return $stmt->execute([            "username" => $username,            "reason" => htmlspecialchars(substr($reason, 0, 256)),            "ip" => General::getClientIp(),            "timestamp" => time()        ]);        return true;    }    static function countRequests() {        $db = Database::connect();        $countRequests = $db->prepare("SELECT COUNT(*) as amount FROM hwid_resets WHERE status='PENDING'");        $countRequests->execute();        return $countRequests->fetch()['amount'];    }    static function checkUserRequest($username) {        $db = Database::connect();        $stmt = $db->prepare('SELECT * FROM hwid_resets WHERE username = :username ORDER BY id DESC LIMIT 1');        $stmt->execute(["username" => $username]);        $data = $stmt->fetch();        switch ($data['status']) {            case "PENDING": // pending                return -1;                break;            case "DENIED": // denied                return 0;                break;            case "APPROVED": // accepted                return 1;                break;            default: // default :3                return 1;                break;        }    }    static function updateStatusRequest($id, $username, $status) {        $db = Database::connect();        // It got accepted, so reset HWID        if($status === 'ACCEPTED') {            self::update($username, 0);        }        $stmt = $db->prepare('UPDATE hwid_resets SET status=:status WHERE id=:id');        $stmt->execute([            "id" => $id,            "status" => $status        ]);    }    static function update($username, $hwid) {        $db = Database::connect();        $stmt = $db->prepare('UPDATE users SET hwid=:hwid WHERE username=:username');        $stmt->execute([            "hwid" => $hwid,            "username" => $username        ]);    }}